<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Space Invaders</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #000;
            color: #fff;
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        h1 {
            margin-bottom: 20px;
            color: #0f0;
            text-shadow: 0 0 10px #0f0;
        }

        #gameContainer {
            position: relative;
            width: 800px;
            height: 600px;
            border: 3px solid #0f0;
            background: linear-gradient(to bottom, #001, #003);
            overflow: hidden;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.3);
        }

        #gameCanvas {
            display: block;
            background: transparent;
        }

        #gameInfo {
            margin-top: 20px;
            display: flex;
            justify-content: space-between;
            width: 800px;
            font-size: 24px;
            color: #0f0;
        }

        #startBtn {
            margin-top: 20px;
            padding: 15px 30px;
            font-size: 20px;
            background: #0f0;
            color: #000;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 0 10px rgba(0, 255, 0, 0.5);
        }

        #startBtn:hover {
            background: #0a0;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.8);
        }

        #gameOver {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 48px;
            color: #f00;
            text-shadow: 0 0 20px #f00;
            display: none;
            z-index: 10;
        }
    </style>
</head>
<body>
    <h1>SPACE INVADERS</h1>

    <div id="gameContainer">
        <canvas id="gameCanvas" width="800" height="600"></canvas>
        <div id="gameOver">GAME OVER</div>
    </div>

    <div id="gameInfo">
        <div>Score: <span id="score">0</span></div>
        <div>Lives: <span id="lives">3</span></div>
    </div>

    <button id="startBtn">START GAME</button>

    <script>
        // Game constants
        const CANVAS_WIDTH = 800;
        const CANVAS_HEIGHT = 600;
        const PLAYER_WIDTH = 40;
        const PLAYER_HEIGHT = 30;
        const ALIEN_WIDTH = 30;
        const ALIEN_HEIGHT = 24;
        const BULLET_WIDTH = 4;
        const BULLET_HEIGHT = 15;
        const PLAYER_SPEED = 5;
        const BULLET_SPEED = 7;
        const ALIEN_BULLET_SPEED = 4;
        const ALIEN_ROWS = 5;
        const ALIEN_COLS = 11;
        const ALIEN_SPACING_X = 50;
        const ALIEN_SPACING_Y = 40;

        // Game variables
        let canvas, ctx;
        let player;
        let aliens = [];
        let bullets = [];
        let alienBullets = [];
        let score = 0;
        let lives = 3;
        let gameRunning = false;
        let alienDirection = 1;
        let alienDropDistance = 20;
        let alienSpeed = 1;
        let lastAlienFire = 0;

        // Player object
        function Player() {
            this.x = CANVAS_WIDTH / 2 - PLAYER_WIDTH / 2;
            this.y = CANVAS_HEIGHT - PLAYER_HEIGHT - 20;
            this.width = PLAYER_WIDTH;
            this.height = PLAYER_HEIGHT;
            this.speed = PLAYER_SPEED;
            this.alive = true;
        }

        Player.prototype.draw = function() {
            ctx.fillStyle = '#00ff00';
            ctx.beginPath();
            ctx.moveTo(this.x + this.width / 2, this.y);
            ctx.lineTo(this.x, this.y + this.height);
            ctx.lineTo(this.x + this.width, this.y + this.height);
            ctx.closePath();
            ctx.fill();

            // Cockpit
            ctx.fillStyle = '#000';
            ctx.fillRect(this.x + this.width / 2 - 5, this.y + 10, 10, 10);
        };

        Player.prototype.update = function() {
            // Handle keyboard input
            if (keys['ArrowLeft'] && this.x > 0) {
                this.x -= this.speed;
            }
            if (keys['ArrowRight'] && this.x < CANVAS_WIDTH - this.width) {
                this.x += this.speed;
            }
        };

        // Alien object
        function Alien(x, y, type) {
            this.x = x;
            this.y = y;
            this.width = ALIEN_WIDTH;
            this.height = ALIEN_HEIGHT;
            this.type = type;
            this.alive = true;
        }

        Alien.prototype.draw = function() {
            ctx.fillStyle = '#ff00ff';

            // Draw different alien types
            if (this.type === 0) {
                // Top row aliens
                ctx.fillRect(this.x + 5, this.y, 20, 8);
                ctx.fillRect(this.x, this.y + 8, 30, 8);
                ctx.fillRect(this.x + 8, this.y + 16, 14, 8);
            } else if (this.type === 1 || this.type === 2) {
                // Middle rows
                ctx.fillRect(this.x, this.y, 30, 8);
                ctx.fillRect(this.x + 8, this.y + 8, 14, 8);
                ctx.fillRect(this.x + 5, this.y + 16, 20, 8);
            } else {
                // Bottom rows
                ctx.fillRect(this.x + 5, this.y, 20, 6);
                ctx.fillRect(this.x, this.y + 6, 30, 6);
                ctx.fillRect(this.x + 3, this.y + 12, 6, 6);
                ctx.fillRect(this.x + 21, this.y + 12, 6, 6);
                ctx.fillRect(this.x + 8, this.y + 18, 14, 6);
            }
        };

        // Bullet object
        function Bullet(x, y, isAlien = false) {
            this.x = x;
            this.y = y;
            this.width = BULLET_WIDTH;
            this.height = BULLET_HEIGHT;
            this.speed = isAlien ? ALIEN_BULLET_SPEED : BULLET_SPEED;
            this.isAlien = isAlien;
            this.active = true;
        }

        Bullet.prototype.draw = function() {
            ctx.fillStyle = this.isAlien ? '#ffff00' : '#00ffff';
            ctx.fillRect(this.x, this.y, this.width, this.height);
        };

        Bullet.prototype.update = function() {
            this.y += this.isAlien ? this.speed : -this.speed;

            // Check if bullet is off screen
            if (this.y < 0 || this.y > CANVAS_HEIGHT) {
                this.active = false;
            }
        };

        // Keyboard input handling
        const keys = {};
        document.addEventListener('keydown', (e) => {
            keys[e.key] = true;
            if (e.key === ' ' && gameRunning) {
                fireBullet();
            }
        });

        document.addEventListener('keyup', (e) => {
            keys[e.key] = false;
        });

        // Fire a bullet
        function fireBullet() {
            const bulletX = player.x + player.width / 2 - BULLET_WIDTH / 2;
            const bulletY = player.y;
            bullets.push(new Bullet(bulletX, bulletY));
        }

        // Initialize game
        function init() {
            canvas = document.getElementById('gameCanvas');
            ctx = canvas.getContext('2d');

            // Create player
            player = new Player();

            // Create aliens
            aliens = [];
            const startX = 100;
            const startY = 60;

            for (let row = 0; row < ALIEN_ROWS; row++) {
                for (let col = 0; col < ALIEN_COLS; col++) {
                    const x = startX + col * ALIEN_SPACING_X;
                    const y = startY + row * ALIEN_SPACING_Y;
                    aliens.push(new Alien(x, y, row));
                }
            }

            // Reset game state
            bullets = [];
            alienBullets = [];
            score = 0;
            lives = 3;
            gameRunning = false;
            alienDirection = 1;
            alienSpeed = 1;

            updateUI();
            draw();
        }

        // Update game UI
        function updateUI() {
            document.getElementById('score').textContent = score;
            document.getElementById('lives').textContent = lives;
        }

        // Game loop
        function gameLoop() {
            if (!gameRunning) return;

            // Clear canvas
            ctx.clearRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);

            // Update and draw player
            player.update();
            player.draw();

            // Update and draw bullets
            bullets = bullets.filter(bullet => bullet.active);
            bullets.forEach(bullet => {
                bullet.update();
                bullet.draw();
            });

            // Update and draw alien bullets
            alienBullets = alienBullets.filter(bullet => bullet.active);
            alienBullets.forEach(bullet => {
                bullet.update();
                bullet.draw();
            });

            // Update and draw aliens
            updateAliens();
            aliens.forEach(alien => {
                if (alien.alive) {
                    alien.draw();
                }
            });

            // Check collisions
            checkCollisions();

            // Check for game over
            checkGameOver();

            // Random alien fire
            const now = Date.now();
            if (now - lastAlienFire > 1000 && aliens.some(a => a.alive)) {
                fireAlienBullet();
                lastAlienFire = now;
            }

            // Next frame
            requestAnimationFrame(gameLoop);
        }

        // Update aliens movement
        function updateAliens() {
            let shouldDrop = false;

            // Move aliens
            aliens.forEach(alien => {
                if (alien.alive) {
                    alien.x += alienDirection * alienSpeed;

                    // Check if aliens reached edge
                    if (alien.x <= 0 || alien.x >= CANVAS_WIDTH - alien.width) {
                        shouldDrop = true;
                    }
                }
            });

            if (shouldDrop) {
                alienDirection *= -1;
                // Drop aliens down
                aliens.forEach(alien => {
                    if (alien.alive) {
                        alien.y += alienDropDistance;
                    }
                });
                // Increase speed
                alienSpeed += 0.2;
            }
        }

        // Fire alien bullet
        function fireAlienBullet() {
            const aliveAliens = aliens.filter(a => a.alive);
            if (aliveAliens.length === 0) return;

            // Select random alien from bottom row
            const bottomAliens = [];
            const columns = {};

            aliveAliens.forEach(alien => {
                const col = Math.floor((alien.x - 100) / ALIEN_SPACING_X);
                if (!columns[col] || alien.y > columns[col].y) {
                    columns[col] = alien;
                }
            });

            for (const col in columns) {
                bottomAliens.push(columns[col]);
            }

            if (bottomAliens.length > 0) {
                const shooter = bottomAliens[Math.floor(Math.random() * bottomAliens.length)];
                const bulletX = shooter.x + shooter.width / 2 - BULLET_WIDTH / 2;
                const bulletY = shooter.y + shooter.height;
                alienBullets.push(new Bullet(bulletX, bulletY, true));
            }
        }

        // Check collisions
        function checkCollisions() {
            // Player bullets vs aliens
            bullets.forEach(bullet => {
                aliens.forEach(alien => {
                    if (alien.alive &&
                        bullet.x < alien.x + alien.width &&
                        bullet.x + bullet.width > alien.x &&
                        bullet.y < alien.y + alien.height &&
                        bullet.y + bullet.height > alien.y) {
                        alien.alive = false;
                        bullet.active = false;
                        score += 10;
                        updateUI();
                    }
                });
            });

            // Alien bullets vs player
            alienBullets.forEach(bullet => {
                if (player.alive &&
                    bullet.x < player.x + player.width &&
                    bullet.x + bullet.width > player.x &&
                    bullet.y < player.y + player.height &&
                    bullet.y + bullet.height > player.y) {
                    bullet.active = false;
                    lives--;
                    updateUI();

                    if (lives <= 0) {
                        player.alive = false;
                    }
                }
            });
        }

        // Check for game over
        function checkGameOver() {
            // Check if all aliens are destroyed (win)
            const allAliensDead = aliens.every(alien => !alien.alive);
            if (allAliensDead) {
                endGame('You Win!');
                return;
            }

            // Check if aliens reached bottom or player died
            const aliensReachedBottom = aliens.some(alien =>
                alien.alive && alien.y + alien.height >= player.y
            );

            if (!player.alive || aliensReachedBottom) {
                endGame('Game Over!');
            }
        }

        // End game
        function endGame(message) {
            gameRunning = false;
            const gameOverElement = document.getElementById('gameOver');
            gameOverElement.textContent = message;
            gameOverElement.style.display = 'block';
            document.getElementById('startBtn').style.display = 'block';
        }

        // Start game
        function startGame() {
            init();
            gameRunning = true;
            document.getElementById('startBtn').style.display = 'none';
            document.getElementById('gameOver').style.display = 'none';
            gameLoop();
        }

        // Initial draw
        function draw() {
            ctx.clearRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);
            player.draw();
            aliens.forEach(alien => alien.draw());
        }

        // Event listeners
        document.getElementById('startBtn').addEventListener('click', startGame);

        // Initialize on page load
        window.addEventListener('load', init);
    </script>
</body>
</html>
